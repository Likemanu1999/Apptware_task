<div class="animated fadeIn">
	<div class="row">
		<div class="col-md-12 p-0">
			<form [formGroup]="salesOrderForm" novalidate (ngSubmit)="onSubmit()" autocomplete="off"
				class="needs-validation">
				<div class="card">
					<div class="card-header">
						<div class="row">
							<div class="col-md-6 card-heading-left">
								<i class="fa fa-plus"></i> {{ page_title }}
							</div>
							<div class="col-md-6 card-heading-right">
								<strong>Booking Date: </strong>
								<i class="fa fa-calendar mx-1"></i>
								{{ salesOrderForm.controls.booking_date.value | date: 'dd-MMM-yyyy' }} &nbsp;
							</div>
						</div>
					</div>
					<div class="card-body">
						<div class="form-row">
							<!-- <div class="col-md-4">
								<div class="form-group">
									<label for="bl_no">BL Number
										<sup class="text-danger"><strong>*</strong></sup>
									</label>
									<ng-select id="bl_no" formControlName="bl_no" placeholder="BL Number"
										[searchable]="true" [clearable]="true" bindLabel="bl_no" bindValue="bl_no"
										[items]="blList" (change)="onChangeValue($event, 'bl_no')">
									</ng-select>
								</div>
							</div> -->
							<div class="col-md-6">
								<div class="form-group">
									<label for="sub_org_id">Customer
										<sup class="text-danger"><strong>*</strong></sup>
									</label>
									<ng-select id="sub_org_id" formControlName="sub_org_id" placeholder="Customer"
										[searchable]="true" [clearable]="true" bindLabel="sub_org_name"
										bindValue="sub_org_id" [items]="customersList"
										(change)="onChangeValue($event, 'customer')">
									</ng-select>
								</div>
							</div>
							<div class="col-md-2">
								<div class="form-group">
									<label for="ie_code">
										IE Code <sup class="text-danger">*</sup>
									</label>
									<input type="text" id="ie_code" class="form-control" formControlName="ie_code"
										placeholder="IE Code" readonly>
								</div>
							</div>
							<div class="col-md-2">
								<div class="form-group">
									<label for="port_id">Port
										<sup class="text-danger"><strong>*</strong></sup>
									</label>
									<ng-select id="port_id" formControlName="port_id" placeholder="Port"
										[searchable]="true" [clearable]="true" bindLabel="port_name" bindValue="port_id"
										[items]="portsList" (change)="onChangeValue($event, 'port')">
									</ng-select>
								</div>
							</div>
							<div class="col-md-2">
								<div class="form-group">
									<label for="inco_term">
										Inco Term <sup class="text-danger">*</sup>
									</label>
									<input type="text" id="inco_term" class="form-control" formControlName="inco_term"
										placeholder="Inco Term" style="text-transform: uppercase;">
								</div>
							</div>
							<div class="col-md-4">
								<div class="form-group">
									<label for="grade_id">Grade
										<sup class="text-danger"><strong>*</strong></sup>
									</label>
									<ng-select id="grade_id" formControlName="grade_id" placeholder="Grade"
										[searchable]="true" [clearable]="true" bindLabel="grade_name"
										bindValue="grade_id" [items]="gradesList"
										(change)="onChangeValue($event, 'grade')">
									</ng-select>
								</div>
							</div>
							<div class="col-md-2">
								<div class="form-group">
									<label for="quantity">Quantity
										<sup class="text-danger"><strong>*</strong></sup>
									</label>
									<div class="input-group">
										<input type="text" class="form-control" id="quantity" formControlName="quantity"
											placeholder="Quantity"
											(change)="onChangeValue($event.target.value, 'quantity')" numbersOnly>
										<div class="input-group-append">
											<span class="input-group-text">
												{{salesOrderForm.controls.unit_type.value}}
											</span>
										</div>
									</div>
								</div>
							</div>
							<div class="col-md-2">
								<div class="form-group">
									<label for="deal_rate">Rate
										<sup class="text-danger"><strong>*</strong></sup>
									</label>
									<div class="input-group">
										<div class="input-group-append">
											<span class="input-group-text">
												<i class="fa fa-usd"></i>
											</span>
										</div>
										<input type="text" class="form-control" id="deal_rate"
											formControlName="deal_rate" placeholder="Rate"
											(change)="onChangeValue($event.target.value, 'deal_rate')" numbersOnly>
									</div>
								</div>
							</div>
							<div class="col-md-2">
								<div class="form-group">
									<label for="base_amount">Base Amount
										<sup class="text-danger"><strong>*</strong></sup>
									</label>
									<div class="input-group">
										<div class="input-group-append">
											<span class="input-group-text">
												<i class="fa fa-usd"></i>
											</span>
										</div>
										<input type="text" class="form-control" id="base_amount"
											formControlName="base_amount" placeholder="Base Amount" readonly>
									</div>
								</div>
							</div>
						</div>
						<div class="form-row">
							<div class="col-md-2">
								<div class="form-group">
									<label for="payment_type">Payment Type
										<sup class="text-danger"><strong>*</strong></sup>
									</label>
									<ng-select id="payment_type" formControlName="payment_type"
										(change)="onChangeValue($event.id, 'payment_type')" placeholder="Payment Type"
										bindLabel="name" bindValue="id" [searchable]="false" [clearable]="false"
										[items]="paymentTypesList">
									</ng-select>
								</div>
							</div>
							<div class="col-md-2">
								<div class="form-group">
									<label for="payment_term">Payment Term
										<sup class="text-danger"><strong>*</strong></sup>
									</label>
									<div class="input-group">
										<input type="text" class="form-control" id="payment_term"
											formControlName="payment_term" placeholder="Payment Term" numbersOnly
											[readonly]="disablePaymentTerm">
										<div class="input-group-append">
											<span class="input-group-text">Days</span>
										</div>
									</div>
								</div>
							</div>
							<div class="col-md-2">
								<div class="form-group">
									<label for="advance">Advance
										<sup class="text-danger"><strong>*</strong></sup>
									</label>
									<div class="input-group">
										<input type="text" class="form-control" id="advance" formControlName="advance"
											placeholder="Advance" numbersOnly [readonly]="disableAdvancePayment">
										<div class="input-group-append">
											<span class="input-group-text">%</span>
										</div>
									</div>
								</div>
							</div>
							<div class="col-md-6">
								<div class="form-group">
									<label for="supplier_id">Supplier
										<sup class="text-danger"><strong>*</strong></sup>
									</label>
									<ng-select id="supplier_id" formControlName="supplier_id" placeholder="Supplier"
										[searchable]="true" [clearable]="true" bindLabel="supplier_name"
										bindValue="sub_org_id" [items]="suppliers"
										(change)="onChangeValue($event, 'supplier')">
									</ng-select>
								</div>
							</div>
							<div class="col-md-6">
								<div class="form-group">
									<label for="packing">Packing
										<sup class="text-danger"><strong>*</strong></sup>
									</label>
									<ng-select id="packing" formControlName="packing" placeholder="Packing"
										[searchable]="true" [clearable]="true" bindLabel="type" bindValue="type"
										[items]="material_packs">
									</ng-select>
								</div>
							</div>
							<div class="col-md-6">
								<div class="form-group">
									<label for="remark">Remark</label>
									<textarea class="form-control" id="remark" formControlName="remark"
										placeholder="Remark"></textarea>
								</div>
							</div>
						</div>
						<div class="temp-contact">
							<div class="form-row">
								<div class="col-md-6">
									<form [formGroup]="newEmailForm" novalidate (ngSubmit)="onSubmitContact('email')"
										autocomplete="off">
										<div class="input-group mb-2">
											<input type="email" id="email" formControlName="email" class="form-control"
												placeholder=" Add New Email">
											<span class="input-group-append">
												<button type="submit" class="btn btn-primary"
													[disabled]="newEmailForm.pristine || newEmailForm.invalid">Add</button>
											</span>
										</div>
									</form>
								</div>
								<div class="col-md-6">
									<form [formGroup]="newMobileForm" novalidate (ngSubmit)="onSubmitContact('mobile')"
										autocomplete="off">
										<div class="input-group mb-2">
											<input type="number" id="mobile_no" formControlName="mobile_no"
												class="form-control" placeholder=" Add New Mobile Number">
											<span class="input-group-append">
												<button type="submit" class="btn btn-primary"
													[disabled]="newMobileForm.pristine || newMobileForm.invalid">Add</button>
											</span>
										</div>
									</form>
								</div>
							</div>
							<div class="form-row">
								<div class="col-md-6">
									<p-chips [(ngModel)]="tempEmailList" formControlName="temp_email"
										placeholder="Temporary Email Address">
									</p-chips>
								</div>
								<div class="col-md-6">
									<p-chips [(ngModel)]="tempMobileList" formControlName="temp_mobile"
										placeholder="Temporary Mobile Number">
									</p-chips>
								</div>
							</div>
						</div>
					</div>
					<div class="card-footer">
						<button type="submit" class="btn btn-primary mr-1"
							[disabled]="salesOrderForm.pristine || salesOrderForm.invalid || tempEmailList.length == 0">
							Submit
						</button>
					</div>
				</div>
			</form>
		</div>
	</div>
</div>

<div bsModal #summaryModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="Summary"
	aria-hidden="true" [config]="{backdrop:'static'}">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title"><i class="fa fa-eye"></i> Summary</h4>
				<button type="button" class="close" (click)="summaryModal.hide()" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body" *ngIf="summary != null">
				<div class="row">
					<div class="col-md-12">
						<p class="mb-1">
							<strong>Booking Date : </strong>
							{{summary.booking_date | date: 'dd-MMM-yyyy'}}
						</p>
						<p class="mb-1">
							<strong>Customer : </strong>
							{{summary.customer}}
						</p>
						<p class="mb-1">
							<strong>Deal Rate : </strong>
							{{summary.deal_rate | currency:currency}}
						</p>
						<p class="mb-1">
							<strong>Quantity : </strong>
							{{summary.quantity}} {{summary.unit_type}}
						</p>
						<p class="mb-1">
							<strong>Base Amount : </strong>
							{{summary.base_amount | currency:currency}}
						</p>
						<p class="mb-1">
							<strong>Port : </strong>
							{{summary.port}}
						</p>
						<p class="mb-1">
							<strong>Payment Term : </strong>
							{{summary.payment_term_label}}
						</p>
						<p class="mb-1">
							<strong>Inco Term : </strong>
							{{summary.inco_term}}
						</p>
						<p class="mb-1">
							<strong>Supplier : </strong>
							{{summary.supplier}}
						</p>
						<p class="mb-1">
							<strong>Packing : </strong>
							{{summary.packing}}
						</p>
						<p class="mb-1">
							<strong>Temp Email : </strong>
							{{summary.temp_email}}
						</p>
						<p class="mb-1">
							<strong>Temp Mobile : </strong>
							{{summary.temp_mobile}}
						</p>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-primary" (click)="confirmSummary();"
					[disabled]="loadingBtn">Confirm <i class="fa fa-spinner fa-spin" *ngIf="loadingBtn"></i></button>
			</div>
		</div>
	</div>
</div>

<toaster-container [toasterconfig]="toasterconfig"></toaster-container>